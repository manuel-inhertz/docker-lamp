# Virtual Hosts
#
# Required modules: mod_log_config

# If you want to maintain multiple domains/hostnames on your
# machine you can setup VirtualHost containers for them. Most configurations
# use only name-based virtual hosts so the server doesn't need to worry about
# IP addresses. This is indicated by the asterisks in the directives below.
#
# Please see the documentation at
# <URL:http://httpd.apache.org/docs/2.4/vhosts/>
# for further details before you try to setup virtual hosts.
#
# You may use the command line option '-S' to verify your virtual host
# configuration.

#
# VirtualHost example:
# Almost any Apache directive may go into a VirtualHost container.
# The first VirtualHost section is used for all requests that do not
# match a ServerName or ServerAlias in any <VirtualHost> block.
#
<FilesMatch \.php$>
    SetHandler "proxy:fcgi://fpm:9000"
</FilesMatch>

TimeOut 3000
ProxyTimeout 3000
<Proxy "proxy:fcgi://fpm:9000">
    #ProxyTimeout 300
</Proxy>

<VirtualHost *:80>
    ServerAdmin webmaster@dummy-host.example.com
    DocumentRoot /var/www/html
    ServerName website.loc
    ServerAlias www.website.loc

    <Directory /var/www/html>
        allow from all
        Options FollowSymLinks MultiViews
        AllowOverride All
        Require all granted
        ####################
        # Mod expire
        ####################
        <ifModule mod_gzip.c>
            mod_gzip_on Yes
            mod_gzip_dechunk Yes
            mod_gzip_item_include file .(html?|txt|css|js|php|pl)$
            mod_gzip_item_include handler ^cgi-script$
            mod_gzip_item_include mime ^text/.*
            mod_gzip_item_include mime ^application/x-javascript.*
            mod_gzip_item_exclude mime ^image/.*
            mod_gzip_item_exclude rspheader ^Content-Encoding:.*gzip.*
        </ifModule>

        ####################
        # Expire headers
        ####################
        <ifModule mod_expires.c>
            ExpiresActive On
            ExpiresDefault \"access plus 5 seconds\"
            ExpiresByType image/x-icon \"access plus 2592000 seconds\"
            ExpiresByType image/jpeg \"access plus 2592000 seconds\"
            ExpiresByType image/png \"access plus 2592000 seconds\"
            ExpiresByType image/gif \"access plus 2592000 seconds\"
            ExpiresByType application/x-shockwave-flash \"access plus 2592000 seconds\"
            ExpiresByType text/css \"access plus 86400 seconds\"
            ExpiresByType text/javascript \"access plus 86400 seconds\"
            ExpiresByType application/javascript \"access plus 86400 seconds\"
            ExpiresByType application/x-javascript \"access plus 86400 seconds\"
            ExpiresByType text/html \"access plus 600 seconds\"
            ExpiresByType application/xhtml+xml \"access plus 600 seconds\"

            AddType application/vnd.ms-fontobject .eot
            AddType application/x-font-ttf .ttf
            AddType application/x-font-opentype .otf
            AddType application/x-font-woff .woff .woff2
            AddType image/svg+xml .svg

            ExpiresByType application/vnd.ms-fontobject \"access plus 2592000 seconds\"
            ExpiresByType application/x-font-ttf \"access plus 2592000 seconds\"
            ExpiresByType application/x-font-opentype \"access plus 2592000 seconds\"
            ExpiresByType application/x-font-woff \"access plus 2592000 seconds\"
            ExpiresByType image/svg+xml \"access plus 2592000 seconds\"
        </ifModule>

        ########################
        # Cache-Control Headers
        ########################
        <ifModule mod_headers.c>
            <filesMatch \"\.(ico|jpe?g|png|gif|swf)$\">
            Header set Cache-Control \"public\"
            </filesMatch>
            <filesMatch \"\.(css)$\">
            Header set Cache-Control \"public\"
            </filesMatch>
            <filesMatch \"\.(js)$\">
            Header set Cache-Control \"private\"
            </filesMatch>
            <filesMatch \"\.(x?html?|php)$\">
            Header set Cache-Control \"private, must-revalidate\"
            </filesMatch>
        </ifModule>
    </Directory>

    ErrorLog /var/log/error.log
    CustomLog /var/log/access.log combined
</VirtualHost>